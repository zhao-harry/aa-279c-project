function q = A2q(A)
    if (A(2,2) > -A(3,3)) && (A(1,1) > -A(2,2)) && (A(1,1) > -A(3,3))
        q = 0.5 * [ ...
            (A(2,3) - A(3,2)) / sqrt(1 + A(1,1) + A(2,2) + A(3,3)); ...
            (A(3,1) - A(1,3)) / sqrt(1 + A(1,1) + A(2,2) + A(3,3)); ...
            (A(1,2) - A(2,1)) / sqrt(1 + A(1,1) + A(2,2) + A(3,3)); ...
            sqrt(1 + A(1,1) + A(2,2) + A(3,3)); ...
            ];
    elseif (A(2,2) < -A(3,3)) && (A(1,1) > A(2,2)) && (A(1,1) > A(3,3))
        q = 0.5 * [ ...
            sqrt(1 + A(1,1) - A(2,2) + A(3,3)); ...
            (A(1,2) + A(2,1)) / sqrt(1 + A(1,1) - A(2,2) - A(3,3)); ...
            (A(3,1) + A(1,3)) / sqrt(1 + A(1,1) - A(2,2) - A(3,3)); ...
            (A(2,3) - A(3,2)) / sqrt(1 + A(1,1) - A(2,2) - A(3,3)); ...
            ];
    elseif (A(2,2) > A(3,3)) && (A(1,1) < A(2,2)) && (A(1,1) < -A(3,3))
        q = 0.5 * [ ...
            (A(1,2) + A(2,1)) / sqrt(1 - A(1,1) + A(2,2) - A(3,3)); ...
            sqrt(1 - A(1,1) + A(2,2) - A(3,3)); ...
            (A(2,3) + A(3,2)) / sqrt(1 - A(1,1) + A(2,2) - A(3,3)); ...
            (A(3,1) - A(1,3)) / sqrt(1 - A(1,1) + A(2,2) - A(3,3)); ...
            ];
    else
        q = 0.5 * [ ...
            (A(3,1) + A(1,3)) / sqrt(1 - A(1,1) - A(2,2) + A(3,3)); ...
            (A(2,3) + A(3,2)) / sqrt(1 - A(1,1) - A(2,2) + A(3,3)); ...
            sqrt(1 - A(1,1) - A(2,2) + A(3,3)); ...
            (A(1,2) - A(2,1)) / sqrt(1 - A(1,1) - A(2,2) + A(3,3)); ...
            ];
    end
end