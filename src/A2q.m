function q = A2q(A)
    q = zeros(4,1);
    q4 = 0.5 * sqrt(1 + A(1,1) + A(2,2) + A(3,3));
    q1 = (A(2,3) - A(3,2))/(4*q4);
    q2 = (A(3,1) - A(1,3))/(4*q4);
    q3 = (A(1,2) - A(2,1))/(4*q4);

    q = [q1; q2; q3; q4];
end